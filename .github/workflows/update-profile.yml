name: Atualizar Perfil

on:
  schedule:
    - cron: "0 */6 * * *"
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v3

      # Instalar jq
      - name: Instalar jq
        run: sudo apt-get update && sudo apt-get install -y jq

      - name: Atualizar Projetos
        run: |
          repos=$(curl -s https://api.github.com/users/edson-syl/repos?per_page=5&sort=updated | jq -r '.[] | "- üîó [" + .name + "](" + .html_url + ")"')
          sed -i "/<!--START_SECTION:repos-->/, /<!--END_SECTION:repos-->/c\<!--START_SECTION:repos-->\n$repos\n<!--END_SECTION:repos-->" README.md

      - name: Frase Aleat√≥ria
        run: |
          frases=("Nunca pare de aprender" "C√≥digo limpo √© c√≥digo feliz" "Errar faz parte do deploy" "Pequenos commits, grandes resultados")
          frase=${frases[$RANDOM % ${#frases[@]}]}
          sed -i "/<!--START_SECTION:frase-->/, /<!--END_SECTION:frase-->/c\<!--START_SECTION:frase-->\n$frase\n<!--END_SECTION:frase-->" README.md

      - name: Atualizar Data
        run: |
          data=$(date)
          sed -i "/<!--START_SECTION:data-->/, /<!--END_SECTION:data-->/c\<!--START_SECTION:data-->\n$data\n<!--END_SECTION:data-->" README.md

      - name: Commit e Push
        run: |
          git config user.name github-actions
          git config user.email actions@github.com
          git add .
          git commit -m "ü§ñ Atualiza√ß√£o autom√°tica do perfil" || echo "Sem mudan√ßas"
          git push
